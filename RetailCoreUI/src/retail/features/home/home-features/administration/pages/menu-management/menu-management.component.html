<!-- <p>project-schedule works!</p> -->
<div class="project-user-list">
    <div class="main-heading d-block mb-2">
        <div class="col-lg-6 page-heading w-100 p-0">
            <h1 class="">Menu Management</h1>
        </div>
    </div>
    <div class="left-filter d-flex align-items-center gap-2">
        <form [formGroup]="frmTextSearch" (ngSubmit)="searchTextMappingList()">
            <input id="searchall" formControlName="txtSearch" class="search" placeholder="Search here..."
                [style]="{ width: '18.875rem' }" />
            <p-button label="Search" class="primarybtn br-1 pr-3" type="submit" />
        </form>
    </div>
    <div class="main-content mt-2">
        <div class="card">
            <div class="table_filter d-flex align-items-center justify-content-end">
                <div class="right-filter col-lg-5 p-0">
                    <div class="d-flex align-items-center justify-content-end gap-2">
                        <p-button label="Add New Mapping" class="primarybtn" (click)="addMappingPopUp()" />
                    </div>
                </div>
            </div>
            <div class="tab-view-wrapper">
                <div class="table">
                    <p-table [value]="lstUserPermissionsView" [scrollable]="true" scrollHeight="400px"
                        [tableStyle]="{ 'min-width': '100%' }">
                        <ng-template pTemplate="header">
                            <tr>
                                <th>User&nbsp;Type/Role</th>
                                <th>Main&nbsp;Menu</th>
                                <th>Sub&nbsp;Menu</th>
                                <th>Created By</th>
                                <th>Created Date</th>
                                <th alignFrozen="right" pFrozenColumn>Actions</th>
                            </tr>
                        </ng-template>
                        <ng-template pTemplate="body" let-item>
                            <tr>
                                <td>{{item.userTypeName}}</td>
                                <td>{{item.mainMenuName}}</td>
                                <td>{{item.subMenuName}}</td>
                                <td>{{item.createdByName}}</td>
                                <td>{{item.createdDate| date:'MM/dd/yyyy'}}</td>
                                <td alignFrozen="right" pFrozenColumn class="a_table text-center">
                                    <span class="d-flex align-items-center gap-10 justify-content-center">
                                        <a (click)="viewMapping(item)" pTooltip="View">
                                            <i>
                                                <svg width="18" height="16" viewBox="0 0 18 16" fill="none"
                                                    xmlns=" http://www.w3.org/2000/svg">
                                                    <path
                                                        d="M1 8C1 8 3.90909 3 9 3C14.0909 3 17 8 17 8C17 8 14.0909 13 9 13C3.90909 13 1 8 1 8Z"
                                                        stroke="#666666" stroke-width="1.3" stroke-linecap="round"
                                                        stroke-linejoin="round" />
                                                    <path
                                                        d="M9 10C10.1046 10 11 9.10457 11 8C11 6.89543 10.1046 6 9 6C7.89543 6 7 6.89543 7 8C7 9.10457 7.89543 10 9 10Z"
                                                        stroke="#666666" stroke-width="1.3" stroke-linecap="round"
                                                        stroke-linejoin="round" />
                                                </svg>
                                            </i>
                                        </a>
                                        <a (click)="editMapping(item)" pTooltip="Edit">
                                            <i>
                                                <svg width="14" height="14" viewBox="0 0 10 10" fill="none"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path
                                                        d="M4.94828 2.13425L5.93104 3.09811L1.37931 7.642V8.62306H2.34483L6.91379 4.06196L7.89655 5.02582L2.93103 10H0V7.07401L4.94828 2.13425ZM7.89655 5.02582L4.94828 2.13425L6.67241 0.413081C6.94827 0.137694 7.27885 0 7.66414 0C8.04897 0 8.37356 0.137694 8.63793 0.413081L9.60345 1.39415C9.86782 1.65806 10 1.97935 10 2.358C10 2.73666 9.86782 3.05795 9.60345 3.32186L7.89655 5.02582Z"
                                                        fill="#666666" />
                                                </svg>
                                            </i>
                                        </a>
                                    </span>
                                </td>
                            </tr>
                        </ng-template>
                    </p-table>
                </div>
            </div>
        </div>
    </div>
</div>
<form [formGroup]="formAddMapping" (ngSubmit)="addMapping()">
    <p-dialog header="{{headerName}}" [(visible)]="addPopUp" [modal]="true"
        [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }" [style]="{ width: '50vw' }" [draggable]="false"
        [resizable]="false" class="restore_pop">
        <div class="filter py-2 mb-3">
            <div class="row mx-0 w-100">
                <div class="col-lg-3 col-md-4 col-ms-12 pl-0 mb-2">
                    <label class="" for="schedulename"><b>User Type/Role:</b><span class="text-danger">*</span></label>
                    <p-multiSelect [options]="lstUserType" formControlName="selectUserType" [filter]="false"
                        optionLabel="name" placeholder="Select" [virtualScroll]="true" [virtualScrollItemSize]="43"
                        class="multiselect-custom-virtual-scroll" />
                    <div class="text-danger"
                        *ngIf="formAddMapping.controls['selectUserType'].invalid && (formAddMapping.controls['selectUserType'].touched  || formAddMapping.controls['selectUserType'].dirty || isAddFormSubmitted)">
                        <span class="required_text"
                            *ngIf="formAddMapping.controls['selectUserType'].errors?.['required']">User Type/Role
                            required</span>
                    </div>
                </div>
            </div>
            <div class="row mx-0 w-100">
                <div class="col-lg-3 col-md-4 col-ms-12 pl-0 mb-2">
                    <label class="" for="schedulename"><b>Main Menu:</b><span class="text-danger">*</span></label>
                    <p-multiSelect [options]="lstMainMenus" formControlName="selectMainMenu" [filter]="false"
                        optionLabel="name" placeholder="Select" [virtualScroll]="true" [virtualScrollItemSize]="43"
                        class="multiselect-custom-virtual-scroll" (onChange)="fillSubMenus()" />
                    <div class="text-danger"
                        *ngIf="formAddMapping.controls['selectMainMenu'].invalid && (formAddMapping.controls['selectMainMenu'].touched  || formAddMapping.controls['selectMainMenu'].dirty || isAddFormSubmitted)">
                        <span class="required_text"
                            *ngIf="formAddMapping.controls['selectMainMenu'].errors?.['required']">Main Menu
                            required</span>
                    </div>
                </div>
                <div class="col-lg-3 col-md-4 col-ms-12 mb-2">
                    <label class="" for="schedulename"><b>Sub Menu:</b></label>
                    <p-multiSelect [options]="lstSubMenus" formControlName="selectSubMenu" [filter]="false"
                        optionLabel="name" placeholder="Select" [virtualScroll]="true" [virtualScrollItemSize]="43"
                        class="multiselect-custom-virtual-scroll" />
                </div>
            </div>
        </div>
        <div class="d-flex align-items-center justify-content-end gap-2 mt-2"  >
            <p-button label="Submit" type="submit" class="primarybtn small" *ngIf="isAddOnly" />
            <p-button label="Revoke" (onClick)="revokeMapping()" class="primarybtn small" *ngIf="isEditOnly" />
            <p-button label="Reset" (onClick)="reset()" class="tertiarybtn small" *ngIf="isAddEditOnly" />
            <p-button label="Cancel" (onClick)="cancel()" class="tertiarybtn small" />
        </div>
    </p-dialog>
</form>
    <p-dialog header="Add New Mapping" [(visible)]="viewPopUp" [modal]="true"
        [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }" [style]="{ width: '50vw' }" [draggable]="false"
        [resizable]="false" class="restore_pop">
        <div class="">
            <div class="row mx-0 w-100">
                <div class="tab-view-wrapper">
                    <div class="table">
                        <p-table [value]="lstUserPermissionsSingle" [scrollable]="true" scrollHeight="400px"
                            [tableStyle]="{ 'min-width': '100%' }">
                            <ng-template pTemplate="header">
                                <tr>
                                    <th>User&nbsp;Type/Role</th>
                                    <th>Main&nbsp;Menu</th>
                                    <th>Sub&nbsp;Menu</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-item>
                                <tr>
                                    <td>{{item.userTypeName}}</td>
                                    <td>{{item.mainMenuName}}</td>
                                    <td>{{item.subMenuName}}</td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </div>
        </div>
        <div class="d-flex align-items-center justify-content-end gap-2 mt-2"  >
            <p-button label="Cancel" (onClick)="cancelView()" class="tertiarybtn small" />
        </div>
    </p-dialog>